# 塔防游戏开发路线图

## 项目概览
- **游戏类型**: 2D塔防 + Roguelite 元素
- **引擎**: Unity
- **开发目录**: `/Users/admin/Documents/TDTestGame`
- **核心玩法**: 放置防御塔抵御怪物，击杀获取经验，升级选择策略卡牌成长

---

## 里程碑规划

### 🎯 Milestone 1: 核心循环最小可玩版本 (MVP)

**目标**: 建立最基础的游戏循环，可以玩一轮

**功能清单**:
- ✅ 单场景测试关卡
- ✅ 单条怪物路径（弯折路径）
- ✅ 基础防御塔放置
  - 点击格子放置/升级/出售
  - 自动攻击范围内最近敌人
- ✅ 基础怪物
  - 沿路径移动
  - 被击杀
  - 到达终点扣血
- ✅ 单波次怪物生成
  - 固定时间间隔生成
  - 固定怪物数量
- ✅ 简单UI
  - 塔选择面板
  - 金币/生命值显示
  - 开始波次按钮

**验收标准**:
- [ ] 玩家可以在路径旁放置至少1个防御塔
- [ ] 怪物从起点出发，沿路径移动到终点
- [ ] 防御塔自动攻击范围内的怪物
- [ ] 怪物被击杀后消失
- [ ] 怪物到达终点扣除生命值
- [ ] 清空所有怪物后显示"胜利"

**技术要点**:
- 使用Unity 2D Sprite系统
- 怪物路径用Waypoint系统
- 塔的攻击用简单的距离判断
- 临时使用Unity自带素材（方块、圆形等）

---

### 🎯 Milestone 2: 多波次系统

**目标**: 实现完整的波次结构，支持3-10波

**功能清单**:
- ✅ 波次数据结构
  - 每波怪物数量
  - 生成间隔
  - 怪物类型（可扩展）
- ✅ 波次管理器
  - 自动顺序执行波次
  - 波次间隔
  - 波次进度显示（当前波/总波次）
- ✅ 波间商店
  - 击杀怪物获得金币
  - 波间可以购买/升级塔
- ✅ 胜利/失败界面
  - 所有波次完成 → 胜利
  - 生命值归零 → 失败

**验收标准**:
- [ ] 关卡可配置3-10波次
- [ ] 波次按顺序自动执行
- [ ] 每波结束后有短暂休息时间
- [ ] 击杀怪物获得金币
- [ ] 完成所有波次显示胜利界面
- [ ] 生命值归零显示失败界面

**技术要点**:
- ScriptableObject存储波次配置
- 波次管理器（WaveManager）统一控制
- 简单的状态机（准备/波次中/波间/胜利/失败）

---

### 🎯 Milestone 3: 关卡选择系统

**目标**: 实现关卡选择界面，支持多个关卡

**功能清单**:
- ✅ 主菜单
  - 开始游戏按钮
  - 关卡选择入口
- ✅ 关卡选择界面
  - 关卡网格布局
  - 关卡锁定/解锁状态
  - 显示关卡信息（难度、波次数）
- ✅ 多关卡支持
  - 至少3个测试关卡
  - 关卡通过后解锁下一关
  - 保存解锁进度
- ✅ 场景跳转
  - 菜单 → 关卡选择 → 游戏场景
  - 游戏结束 → 返回菜单/关卡选择

**验收标准**:
- [ ] 主菜单可进入关卡选择
- [ ] 关卡选择界面显示至少3个关卡
- [ ] 第一关默认解锁，后续关卡锁定
- [ ] 通过关卡后下一关解锁
- [ ] 可以点击已解锁关卡进入游戏
- [ ] 游戏结束后可返回菜单

**技术要点**:
- 场景管理（SceneManager）
- PlayerPrefs保存解锁进度
- 关卡数据结构（难度、波次配置引用）

---

### 🎯 Milestone 4: Roguelite 经验与卡牌系统

**目标**: 实现击杀升级和3选1策略卡牌

**功能清单**:
- ✅ 经验系统
  - 击杀怪物获得经验值
  - 经验条显示
  - 升级触发
- ✅ 等级系统
  - 等级上限（如10-15级）
  - 每级所需经验递增
- ✅ 策略卡牌池
  - 攻击强化类（伤害、攻速、范围）
  - 防御强化类（金币获取、生命回复）
  - 特殊效果类（暴击、穿透）
- ✅ 3选1卡牌界面
  - 升级时暂停游戏
  - 显示3张随机卡牌
  - 卡牌描述清晰
  - 选择后立即生效，游戏继续

**验收标准**:
- [ ] 击杀怪物增加经验值
- [ ] 经验满后触发升级
- [ ] 升级时游戏暂停并弹出3张卡牌
- [ ] 卡牌效果描述清晰
- [ ] 选择卡牌后效果生效，游戏继续
- [ ] 等级上限可配置

**技术要点**:
- 玩家数据管理（PlayerStats）
- 卡牌数据结构（ScriptableObject）
- 随机卡牌选择逻辑
- 暂停/恢复游戏时序（Time.timeScale）

---

### 🎯 Milestone 5: 防御塔升级与分支

**目标**: 实现防御塔的升级路径和不同流派

**功能清单**:
- ✅ 多种基础塔类型（3种）
  - 射手塔（单体高伤）
  - 炮塔（范围AOE）
  - 冰霜塔（减速）
- ✅ 塔的升级系统
  - 每种塔3级升级路径
  - 升级消耗金币
  - 升级提升属性（伤害、范围、攻速）
- ✅ 升级分支（每塔2条路线）
  - 射手塔: 暴击流 vs 攻速流
  - 炮塔: 大范围流 vs 高伤流
  - 冰霜塔: 深冻结流 vs 减速范围流
- ✅ 塔的显示效果
  - 不同等级外观差异
  - 不同分支特效区分

**验收标准**:
- [ ] 可建造3种不同类型的基础塔
- [ ] 每种塔可以升级到最高级
- [ ] 升级时显示分支选择（2选1）
- [ ] 不同分支有明显的效果差异
- [ ] 分支选择后不能更换
- [ ] 塔的外观随升级变化

**技术要点**:
- 塔数据结构（继承基类或配置化）
- 升级树数据结构
- 塔的属性计算系统
- 精灵替换/特效系统

---

### 🎯 Milestone 6: 关卡难度递进

**目标**: 实现关卡间的难度曲线，提供挑战性

**功能清单**:
- ✅ 关卡难度参数
  - 波次数量递增（3→5→7→9→10）
  - 怪物血量递增
  - 怪物速度递增
  - 金币获取调整
- ✅ 多种怪物类型
  - 普通怪（血量低，速度快）
  - 坦克怪（血量高，速度慢）
  - 精英怪（各项属性高）
  - Boss怪（特殊能力，单波次）
- ✅ 关卡特色
  - 不同路径形状（直线、S型、多岔路）
  - 不同地形障碍
- ✅ 难度平衡
  - 首关容易上手
  - 中期有挑战性
  - 后关需要策略组合

**验收标准**:
- [ ] 至少5个关卡，难度递进明显
- [ ] 高关卡怪物体力和速度明显提升
- [ ] 不同关卡路径形状不同
- [ ] 高关卡出现多种怪物类型
- [ ] 后关卡需要合理搭配塔和升级策略才能过关

**技术要点**:
- 关卡配置数据结构
- 怪物类型系统（继承基类）
- 难度系数计算公式
- 关卡设计工具（可选）

---

### 🎯 Milestone 7: 美术素材与UI优化

**目标**: 替换临时素材，提升游戏观感

**功能清单**:
- ✅ 美术资源准备
  - 防御塔精灵图（每种塔+各级）
  - 怪物精灵图（不同类型）
  - 地形图块（草地、路径、基地）
  - 卡牌UI设计
  - 按钮和面板UI
- ✅ 素材来源
  - 免费素材网站（Itch.io, OpenGameArt, Kenney.nl）
  - 或使用简单几何图形配色优化
- ✅ UI优化
  - 统一风格
  - 清晰的信息层级
  - 动画过渡效果
  - 伤害数字飘字

**验收标准**:
- [ ] 防御塔有清晰的视觉区分
- [ ] 怪物有辨识度
- [ ] 路径和地形清晰可见
- [ ] 卡牌UI美观易读
- [ ] 所有按钮和面板风格统一
- [ ] 攻击有视觉反馈（弹道/特效）

**技术要点**:
- Sprite图集优化
- 动画系统使用
- UI层级管理
- 粒子特效（可选）

---

### 🎯 Milestone 8: 最终打磨与优化

**目标**: 完善细节，确保游戏体验流畅

**功能清单**:
- ✅ 音效与音乐（可选）
  - 攻击音效
  - 怪物死亡音效
  - 升级音效
  - 背景音乐
- ✅ 游戏平衡调整
  - 塔的数值微调
  - 关卡难度微调
  - 卡牌平衡性调整
- ✅ 性能优化
  - 对象池（怪物、弹道）
  - 批量渲染
- ✅ 用户体验优化
  - 操作引导（首关）
  - 暂停/继续功能
  - 重新开始/退出
  - 存档读取提示

**验收标准**:
- [ ] 游戏运行流畅，无明显卡顿
- [ ] 所有关卡可正常通关
- [ ] 没有明显的数值平衡问题
- [ ] 操作反馈及时清晰
- [ ] 可以随时暂停/退出

**技术要点**:
- 对象池模式
- 配置表外置（JSON/ScriptableObject）
- 错误处理和日志
- 性能分析工具使用

---

## 素材来源建议

### 免费美术素材
1. **Kenney.nl** - 2D游戏素材包（塔防、UI都有）
2. **OpenGameArt.org** - 开源游戏美术资源
3. **Itch.io** - 免费游戏素材（搜索"tower defense assets"）
4. **Game-Icons.net** - 图标素材

### 免费音效
1. **Freesound.org** - 音效库
2. **Zapsplat.com** - 免费音效
3. **Itch.io** - 免费音效包

### 自制方案（推荐）
- 使用简单的几何图形 + 鲜明配色
- Unity内置粒子系统制作特效
- 用代码实现简单动画

---

## 开发建议

### 开发顺序
严格按里程碑顺序开发，每个里程碑完成后充分测试再进入下一个。

### 代码组织
```
Scripts/
├── Core/          # 核心系统（GameManager, WaveManager等）
├── Towers/        # 塔相关脚本
├── Enemies/       # 怪物相关脚本
├── Player/        # 玩家数据、升级系统
├── UI/            # UI控制器
├── Data/          # 数据结构、配置类
└── Utilities/     # 工具类
```

### 配置优先
使用ScriptableObject或JSON配置游戏数据，便于调整平衡性。

### 版本控制
每个里程碑完成后打Git tag（如 `v0.1-milestone1`）。

---

## 进度跟踪

| 里程碑 | 状态 | 完成日期 | 备注 |
|--------|------|----------|------|
| M1: MVP核心循环 | ⬜ 未开始 | - | - |
| M2: 多波次系统 | ⬜ 未开始 | - | - |
| M3: 关卡选择 | ⬜ 未开始 | - | - |
| M4: Roguelite系统 | ⬜ 未开始 | - | - |
| M5: 塔升级分支 | ⬜ 未开始 | - | - |
| M6: 关卡难度递进 | ⬜ 未开始 | - | - |
| M7: 美术优化 | ⬜ 未开始 | - | - |
| M8: 最终打磨 | ⬜ 未开始 | - | - |

---

*最后更新: 2025-02-01*
