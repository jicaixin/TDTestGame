# 游戏设计文档 (GDD)
# 2D塔防Roguelite

---

## 1. 游戏概述

### 1.1 基本信息
- **游戏名称**: 塔防挑战 (暂定)
- **游戏类型**: 2D塔防 + Roguelite
- **平台**: PC/移动端（Unity开发）
- **视角**: 俯视2D
- **核心玩法**: 通过放置和升级防御塔抵御多波次怪物进攻，击杀怪物获得经验，升级选择策略卡牌强化能力

### 1.2 核心循环
```
准备 → 建造/升级塔 → 开始波次 → 击杀怪物获得经验 → 
升级选择卡牌 → 建造/升级塔 → 下一波 → ... → 胜利/失败
```

---

## 2. 玩法机制

### 2.1 关卡系统

#### 关卡结构
- **关卡数量**: 10-15关（M1阶段3关，后续扩展）
- **波次范围**: 3-10波/关
- **解锁机制**: 通过前一关解锁下一关
- **难度递增**: 随关卡提升
  - 波次数量增加
  - 怪物属性提升
  - 怪物类型增加

#### 关卡配置示例
```json
{
  "levelId": 1,
  "name": "新手教程",
  "difficulty": 1,
  "waves": 3,
  "baseHealth": 20,
  "startGold": 100,
  "path": [...] // 路径点坐标
}
```

### 2.2 波次系统

#### 波次结构
- 每波固定数量怪物
- 生成间隔可配置
- 波次间有短暂休息期（可建造/升级）
- 所有波次完成判定胜利

#### 波次配置示例
```json
{
  "waveId": 1,
  "enemies": [
    {"type": "basic", "count": 5, "interval": 2.0},
    {"type": "basic", "count": 3, "interval": 1.5}
  ]
}
```

### 2.3 防御塔系统

#### 基础塔类型（3种）

**射手塔 (Archer Tower)**
- 定位: 单体高伤害
- 初始属性:
  - 伤害: 20
  - 攻速: 1.0次/秒
  - 范围: 3格
  - 成本: 50金币
- 升级分支:
  - **暴击流**: 增加暴击率和暴击伤害
  - **攻速流**: 大幅提升攻击速度

**炮塔 (Cannon Tower)**
- 定位: 范围AOE伤害
- 初始属性:
  - 伤害: 30 (AOE)
  - 攻速: 0.5次/秒
  - 范围: 2.5格
  - AOE半径: 1.5格
  - 成本: 80金币
- 升级分支:
  - **大范围流**: 增加AOE半径
  - **高伤流**: 增加伤害

**冰霜塔 (Frost Tower)**
- 定位: 控制减速
- 初始属性:
  - 伤害: 10
  - 攻速: 1.0次/秒
  - 范围: 2.5格
  - 减速: 30%
  - 成本: 60金币
- 升级分支:
  - **深冻结流**: 增加减速效果和持续时间
  - **范围减速流**: 增加减速范围

#### 塔的升级
- 每种塔最多3级
- 每级需要2选1分支
- 升级消耗金币（递增）
- 升级属性:
  - 伤害 +20%/级
  - 攻速 +10%/级
  - 范围 +10%/级

#### 塔的操作
- **放置**: 点击格子选择塔类型建造
- **升级**: 点击已建塔显示升级选项（2选1）
- **查看**: 点击塔显示属性和升级树
- **出售**: 点击已建塔显示出售选项（返还50%金币）

### 2.4 怪物系统

#### 怪物类型

**普通怪 (Basic)**
- 血量: 50
- 速度: 1.0
- 奖励: 10金币 + 15经验
- 特点: 无特殊能力

**快速怪 (Fast)**
- 血量: 30
- 速度: 2.0
- 奖励: 8金币 + 10经验
- 特点: 速度快，血量低

**坦克怪 (Tank)**
- 血量: 200
- 速度: 0.5
- 奖励: 30金币 + 50经验
- 特点: 血量高，速度慢

**精英怪 (Elite)**
- 血量: 100
- 速度: 1.2
- 奖励: 20金币 + 30经验
- 特点: 各项属性均衡偏高

**Boss怪**
- 血量: 500
- 速度: 0.8
- 奖励: 100金币 + 200经验
- 特点: 单波次，特殊技能（如召唤小怪）

#### 怪物属性随关卡调整
- 血量 = 基础血量 × (1 + 关卡难度 × 0.1)
- 速度 = 基础速度 × (1 + 关卡难度 × 0.05)

### 2.5 Roguelite经验系统

#### 经验获取
- 击杀怪物获得经验
- 经验值随关卡递增

| 怪物类型 | 经验值 |
|---------|--------|
| 普通怪 | 15 × 关卡系数 |
| 快速怪 | 10 × 关卡系数 |
| 坦克怪 | 50 × 关卡系数 |
| 精英怪 | 30 × 关卡系数 |
| Boss怪 | 200 × 关卡系数 |

#### 等级系统
- 等级上限: 15级
- 每级所需经验递增

| 等级 | 所需经验 | 累计经验 |
|------|----------|----------|
| 1→2 | 100 | 100 |
| 2→3 | 150 | 250 |
| 3→4 | 200 | 450 |
| 4→5 | 300 | 750 |
| ... | ... | ... |
| 14→15 | 2000 | 10000 |

### 2.6 策略卡牌系统

#### 卡牌分类

**攻击强化类**
- "致命一击": 塔的暴击率 +15%
- "急速射击": 塔的攻击速度 +20%
- "穿透箭": 射手塔子弹可穿透1个敌人
- "炮火覆盖": 炮塔AOE范围 +30%

**防御强化类**
- "金手": 击杀怪物金币 +20%
- "生命恢复": 回复5点生命值
- "坚固防守": 塔的伤害 +15%

**特殊效果类**
- "冰冻风暴": 冰霜塔减速效果 +10%
- "连击": 塔有10%概率触发双倍攻击
- "治疗波": 每波结束后回复2点生命值
- "能量爆发": 获得50金币

#### 卡牌选择
- 每次升级弹出3张随机卡牌
- 卡牌从卡池随机抽取
- 卡牌效果永久生效（单局内）
- 不可重复选择同一张卡

---

## 3. UI/UX设计

### 3.1 游戏主界面

```
┌─────────────────────────────────────┐
│  [生命:20]  [波次:1/5]  [金币:100]  │
├─────────────────────────────────────┤
│                                     │
│         游戏画面区域                 │
│    (路径、塔、怪物显示)             │
│                                     │
├─────────────────────────────────────┤
│  [塔选择面板]                       │
│  [射手塔50] [炮塔80] [冰霜塔60]     │
│                                     │
│  [开始下一波] [暂停] [退出]         │
└─────────────────────────────────────┘
```

### 3.2 关卡选择界面

```
┌─────────────────────────────────────┐
│         关卡选择                     │
├─────────────────────────────────────┤
│                                     │
│   [关卡1: 新手教程] [关卡2: 进阶]    │
│      ⭐⭐⭐            🔒            │
│      波次:3           波次:5         │
│                                     │
│   [关卡3: 挑战]   [关卡4: 困难]      │
│      🔒              🔒              │
│                                     │
├─────────────────────────────────────┤
│         [返回主菜单]                │
└─────────────────────────────────────┘
```

### 3.3 升级卡牌界面

```
┌─────────────────────────────────────┐
│         升级! 选择一张卡牌           │
├─────────────────────────────────────┤
│                                     │
│   ┌─────────┐   ┌─────────┐   ┌────┐│
│   │ 致命一击 │   │ 金手    │   │连击 ││
│   │         │   │         │   │    ││
│   │ 暴击率+15%│ │ 金币+20%│ │ 10%││
│   │         │   │         │   │双倍││
│   └─────────┘   └─────────┘   └────┘│
│                                     │
└─────────────────────────────────────┘
```

### 3.4 塔信息面板
```
┌─────────┐
│ 射手塔 Lv2 │
├─────────┤
│ 伤害: 24  │
│ 攻速: 1.1/s│
│ 范围: 3.3 │
├─────────┤
│ [升级] [出售]│
└─────────┘
```

---

## 4. 数值平衡

### 4.1 经济系统
- 初始金币: 100
- 击杀奖励: 8-30金币（怪物类型）
- 波次完成奖励: 20-50金币（波次难度）

### 4.2 生命值系统
- 初始生命: 20
- 每个怪物到达终点: -1生命
- 生命值归零: 失败

### 4.3 难度曲线
- 关卡1-3: 新手教学，容易通关
- 关卡4-6: 需要策略搭配
- 关卡7-10: 高难度，需要合理利用卡牌系统

---

## 5. 技术实现要点

### 5.1 核心系统
- **GameManager**: 游戏流程控制
- **WaveManager**: 波次管理
- **EnemySpawner**: 怪物生成
- **TowerManager**: 塔的管理
- **Pathfinding**: 简单路径跟随（Waypoint）

### 5.2 数据结构
- 使用ScriptableObject存储配置数据
- 关卡数据、波次数据、塔数据、怪物数据都配置化

### 5.3 性能优化
- 对象池管理怪物和弹道
- 使用Sprite Atlas优化渲染

---

## 6. 扩展方向（未来）
- 更多塔类型（5-10种）
- 更多怪物类型（Boss技能）
- 无尽模式
- 每日挑战
- 成就系统
- 装饰品/皮肤系统

---

*最后更新: 2025-02-01*
